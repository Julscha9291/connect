<VirtualHost *:80>
    ServerName connect.julianschaepermeier.com
    Redirect permanent / https://connect.julianschaepermeier.com/
</VirtualHost>

<VirtualHost *:443>
    ServerName connect.julianschaepermeier.com

    # Statische Dateien für das React-Frontend
    DocumentRoot /usr/local/apache2/htdocs/
    <Directory /usr/local/apache2/htdocs/>
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>

    # Django Backend über WSGI
    WSGIDaemonProcess connect python-path=/app
    WSGIScriptAlias /api /app/wsgi.py
    WSGIPassAuthorization On

    <Directory /app>
        <Files wsgi.py>
            Require all granted
        </Files>
    </Directory>

    # Statische und Medien-Dateien für Django
    Alias /static/ /app/staticfiles/
    <Directory /app/staticfiles>
        Require all granted
    </Directory>

    Alias /media/ /app/media/
    <Directory /app/media>
        Require all granted
    </Directory>

    # SSL-Konfiguration
    SSLEngine on
    SSLProtocol +TLSv1.2 +TLSv1.3
    SSLCertificateFile /etc/ssl/certs/julianschaepermeier.com_ssl_certificate.pem
    SSLCertificateKeyFile /etc/ssl/private/_.julianschaepermeier.com_private_key.key
    SSLCertificateChainFile /etc/ssl/certs/intermediate1.pem

    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>
